# Функціональність створення магазинів

## Опис
Система дозволяє користувачам (крім адміністраторів) створювати запити на створення магазинів, які розглядаються адміністраторами.

## Основні можливості

### Для користувачів (не-адміністраторів):
1. **Створення запиту на магазин** - кнопка "Створити магазин" на сторінці `/favorites`
2. **Редагування запиту** - можливість змінити назву та опис магазину (тільки для запитів зі статусом "Pending")
3. **Видалення запиту** - можливість видалити запит (тільки для запитів зі статусом "Pending")
4. **Перегляд статусу** - відображення поточного статусу запиту (Pending/Approved/Rejected)

### Для адміністраторів:
1. **Перегляд всіх запитів** - сторінка `/admin/stores` з вкладкою "Заявки на створення"
2. **Схвалення запитів** - можливість схвалити запит на створення магазину
3. **Відхилення запитів** - можливість відхилити запит з вказівкою причини
4. **Перегляд існуючих магазинів** - вкладка "Існуючі магазини" з списком всіх створених магазинів

## API Ендпоінти

### Створення запиту
- **POST** `/api/stores/create-request`
- **Body**: `{ storeName: string, description: string }`
- **Обмеження**: Тільки для не-адміністраторів

### Отримання запитів користувача
- **GET** `/api/stores/my-request`
- **Повертає**: Список запитів поточного користувача

### Отримання всіх запитів (адміністратори)
- **GET** `/api/stores/all-requests`
- **Повертає**: Список всіх запитів на створення магазинів

### Схвалення запиту
- **POST** `/api/stores/approve-request`
- **Body**: `{ requestId: string }`
- **Обмеження**: Тільки для адміністраторів

### Відхилення запиту
- **POST** `/api/stores/reject-request`
- **Body**: `{ requestId: string, reason?: string }`
- **Обмеження**: Тільки для адміністраторів

### Оновлення запиту
- **PUT** `/api/stores/update-request`
- **Body**: `{ requestId: string, storeName: string, description: string }`

### Видалення запиту
- **DELETE** `/api/stores/delete-request?requestId={id}`

## Зовнішні API (api.sellpoint.pp.ua)

Система інтегрується з наступними ендпоінтами:

- `POST /api/Store/CreateStore` - створення запиту
- `GET /api/Store/GetAllRequests` - отримання всіх запитів
- `GET /api/Store/GetRequestByMyId` - отримання запитів користувача
- `POST /api/Store/ApproveRequest` - схвалення запиту
- `POST /api/Store/RejectRequest` - відхилення запиту
- `PUT /api/Store/UpdateRequest` - оновлення запиту
- `DELETE /api/Store/DeleteRequest` - видалення запиту
- `GET /api/Store/GetStores` - отримання всіх магазинів
- `GET /api/User/CheckAdmin` - перевірка адміністративних прав

## Статуси запитів

1. **Pending** - запит на розгляді
2. **Approved** - запит схвалено, магазин створено
3. **Rejected** - запит відхилено

## Логіка роботи

### Для користувачів:
1. Користувач натискає "Створити магазин" на `/favorites`
2. Система перевіряє чи користувач не є адміністратором
3. Якщо адміністратор - показує повідомлення про неможливість створення
4. Якщо не адміністратор - відкриває модальне вікно для введення даних
5. Після створення запиту користувач бачить його статус
6. Можливість редагувати/видаляти запит (тільки для статусу "Pending")

### Для адміністраторів:
1. Адміністратор переходить на `/admin/stores`
2. Бачить вкладку "Заявки на створення" з усіма запитами
3. Може переглядати деталі кожного запиту
4. Може схвалити або відхилити запит
5. При відхиленні може вказати причину
6. Може переглядати існуючі магазини на вкладці "Існуючі магазини"

## Файли системи

### Клієнтські компоненти:
- `src/app/favorites/page.tsx` - сторінка з кнопкою створення запиту
- `src/app/admin/stores/page.tsx` - адміністративна сторінка управління
- `src/app/admin/stores/layout.tsx` - лейаут з захистом адміністративних прав

### API маршрути:
- `src/app/api/stores/create-request/route.ts`
- `src/app/api/stores/my-request/route.ts`
- `src/app/api/stores/all-requests/route.ts`
- `src/app/api/stores/approve-request/route.ts`
- `src/app/api/stores/reject-request/route.ts`
- `src/app/api/stores/update-request/route.ts`
- `src/app/api/stores/delete-request/route.ts`

### Оновлені компоненти:
- `src/components/admin/AdminSidebar.tsx` - додано пункт "Магазини"

## Налаштування

Для роботи системи потрібно налаштувати змінну середовища:
```
NEXT_PUBLIC_API_URL=https://api.sellpoint.pp.ua
```

## Безпека

1. Всі API ендпоінти перевіряють авторизацію
2. Адміністративні дії доступні тільки адміністраторам
3. Користувачі можуть редагувати тільки свої запити
4. Адміністратори не можуть створювати запити на магазини

