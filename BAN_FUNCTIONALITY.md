# Функціональність банів користувачів

## Огляд

Реалізована проста функціональність для управління банів користувачів в адміністративній панелі. Система включає:

1. **Виділення поточного користувача** - зеленим кольором з позначкою "Ви"
2. **Простий бан** - можливість блокувати та розблоковувати користувачів
3. **Повідомлення про бан** - для заблокованих користувачів
4. **Статус бану** - відображення в списку користувачів

## Основні функції

### 1. Виділення поточного користувача

- Поточний користувач (який залогінений) відображається зеленим кольором
- Зелена лінія зліва від рядка користувача
- Зелений текст для імені, email та дати реєстрації
- Позначка "Ви" біля імені користувача

### 2. Функціональність банів

#### Блокування користувача:
- Кнопка "Забанити" для кожного користувача (крім себе та вже заблокованих)
- Модальне вікно з формою блокування:
  - Причина блокування (обов'язково)
- Абсолютний бан назавжди (без дат закінчення)
- Сповіщення про успішне блокування

#### Розблокування користувача:
- Кнопка "Розбанити" в детальному перегляді користувача
- Миттєве оновлення статусу
- Сповіщення про успішне розблокування

### 3. Повідомлення про бан

Для заблокованих користувачів показується просте повідомлення:
- Текст про блокування акаунту
- Інструкція звернутися до адміністратора
- Можливість закрити повідомлення

### 4. Статус бану

В списку користувачів:
- Колонка "Статус" з індикатором "Активний" або "Заблокований"
- Заблоковані користувачі не можуть бути заблоковані знову
- В детальному перегляді показується причина бану та можливість розблокування

## API Ендпоінти

### Клієнтські API роути:

1. **GET /api/users/current** - отримання інформації про поточного користувача
2. **GET /api/users/all** - отримання списку всіх користувачів
3. **GET /api/users/bans?userId={id}** - отримання банів користувача
4. **POST /api/users/ban** - блокування користувача
5. **POST /api/users/unban** - розблокування користувача

### Серверні API ендпоінти:

1. **POST /api/User/BanUser** - блокування користувача
2. **POST /api/User/UnbanUser** - розблокування користувача
3. **GET /api/User/GetAllByUserId** - отримання банів користувача
4. **GET /api/User/GetUserByMyId** - отримання інформації про поточного користувача
5. **GET /api/User/GetAllUsers** - отримання списку всіх користувачів

## Компоненти

### 1. BanNotification
- Простий компонент для відображення повідомлення про бан
- Розташований: `src/components/auth/BanNotification.tsx`
- Використовується в ProtectedRoute для заблокованих користувачів

### 2. Оновлений ProtectedRoute
- Проста перевірка банів користувача
- Автоматичне відображення повідомлення про бан
- Розташований: `src/components/auth/ProtectedRoute.tsx`

### 3. Оновлена сторінка користувачів
- Проста функціональність управління банів
- Виділення поточного користувача
- Відображення статусу бану
- Розташована: `src/app/admin/users/page.tsx`

## Тип бану

Система використовує тільки один тип блокування:
- **Login** - блокування входу в систему (абсолютний бан)

## Безпека

1. **Перевірка прав доступу** - тільки адміністратори можуть блокувати користувачів
2. **Захист від самоблокування** - адміністратор не може заблокувати себе
3. **Валідація даних** - перевірка обов'язкових полів
4. **Токен авторизації** - всі запити вимагають валідного токена

## Логіка роботи

### Процес блокування:
1. Адміністратор вибирає користувача для блокування
2. Заповнює форму з причиною блокування
3. Система відправляє запит на сервер
4. Сервер створює запис про бан в базі даних
5. Користувач отримує повідомлення про бан при наступному вході

### Процес розблокування:
1. Адміністратор відкриває деталі користувача
2. Переглядає інформацію про бан
3. Натискає кнопку "Розбанити"
4. Система видаляє запис про бан
5. Користувач може знову увійти в систему

## Налаштування

### Конфігурація API:
- Базовий URL: `https://api.sellpoint.pp.ua`
- Всі запити вимагають заголовок `Authorization: Bearer {token}`

### Стилізація:
- Використовується Tailwind CSS
- Зелений колір для поточного користувача: `text-green-700`, `bg-green-50`
- Червоний колір для банів: `text-red-600`, `bg-red-50`

## Підтримка

При виникненні проблем:
1. Перевірте консоль браузера на наявність помилок
2. Перевірте мережеві запити в DevTools
3. Переконайтеся, що токен авторизації валідний
4. Перевірте права доступу користувача
